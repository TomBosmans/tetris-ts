(this["webpackJsonptetris-ts"]=this["webpackJsonptetris-ts"]||[]).push([[0],{16:function(e,t,E){e.exports=E(23)},23:function(e,t,E){"use strict";E.r(t);var T=E(0),n=E.n(T),r=E(11),M=E.n(r);function Y(e,t){var E=Object(T.useRef)();Object(T.useEffect)((function(){E.current=e}),[e]),Object(T.useEffect)((function(){if(null!==t){var e=setInterval((function(){return E.current&&E.current()}),t);return function(){return clearInterval(e)}}}),[t])}function P(e){var t=e.width,E=e.height,r=e.draw,M=e.delay,P=void 0===M?1e3:M,c=Object(T.useRef)(null);return Y((function(){var e=c.current,t=null===e||void 0===e?void 0:e.getContext("2d");t&&r(t)}),P),n.a.createElement("canvas",{ref:c,width:t,height:E})}var c,o=[0,40,100,300,1200];!function(e){e.EMPTY=" ",e.O="o",e.S="s",e.Z="z",e.I="i",e.J="j",e.T="t",e.L="l"}(c||(c={}));var a,u={" ":"#e5e9f0",o:"#bf616a",s:"#d08770",z:"#ebcb8b",i:"#a3be8c",j:"#b48ead",t:"#5e81ac",l:"#8fbcbb"};!function(e){e.MOVE_BLOCK_DOWN="MOVE_BLOCK_DOWN",e.MOVE_BLOCK_LEFT="MOVE_BLOCK_LEFT",e.MOVE_BLOCK_RIGHT="MOVE_BLOCK_RIGHT",e.ROTATE_BLOCK_LEFT="ROTATE_BLOCK_LEFT",e.ROTATE_BLOCK_RIGHT="ROTATE_BLOCK_RIGHT"}(a||(a={}));var l={o:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.O,c.O,c.EMPTY],[c.EMPTY,c.O,c.O,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]],s:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.S,c.S,c.EMPTY],[c.S,c.S,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.S,c.EMPTY,c.EMPTY,c.EMPTY],[c.S,c.S,c.EMPTY,c.EMPTY],[c.EMPTY,c.S,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]],z:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.Z,c.Z,c.EMPTY,c.EMPTY],[c.EMPTY,c.Z,c.Z,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.Z,c.EMPTY,c.EMPTY],[c.Z,c.Z,c.EMPTY,c.EMPTY],[c.Z,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]],i:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.I,c.I,c.I,c.I],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.I,c.EMPTY,c.EMPTY],[c.EMPTY,c.I,c.EMPTY,c.EMPTY],[c.EMPTY,c.I,c.EMPTY,c.EMPTY],[c.EMPTY,c.I,c.EMPTY,c.EMPTY]]],j:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.J,c.J,c.J,c.EMPTY],[c.EMPTY,c.EMPTY,c.J,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.J,c.EMPTY,c.EMPTY],[c.EMPTY,c.J,c.EMPTY,c.EMPTY],[c.J,c.J,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.J,c.EMPTY,c.EMPTY,c.EMPTY],[c.J,c.J,c.J,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.J,c.J,c.EMPTY],[c.EMPTY,c.J,c.EMPTY,c.EMPTY],[c.EMPTY,c.J,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]],t:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.T,c.T,c.T,c.EMPTY],[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.T,c.T,c.EMPTY,c.EMPTY],[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.T,c.T,c.T,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.EMPTY,c.T,c.T,c.EMPTY],[c.EMPTY,c.T,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]],l:[[[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.L,c.L,c.L,c.EMPTY],[c.L,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.L,c.L,c.EMPTY,c.EMPTY],[c.EMPTY,c.L,c.EMPTY,c.EMPTY],[c.EMPTY,c.L,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.EMPTY,c.L,c.EMPTY],[c.L,c.L,c.L,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]],[[c.EMPTY,c.L,c.EMPTY,c.EMPTY],[c.EMPTY,c.L,c.EMPTY,c.EMPTY],[c.EMPTY,c.L,c.L,c.EMPTY],[c.EMPTY,c.EMPTY,c.EMPTY,c.EMPTY]]]},i=E(15),f=E(1),s=E(8),O=function(){return Array(10).fill(c.EMPTY)};function v(){var e=[c.I,c.J,c.L,c.O,c.S,c.T,c.Z],t=Math.floor(Math.random()*e.length);return{shape:e[t],offsetX:3,offsetY:0,rotation:0}}function d(e,t){var E=l[e.shape][e.rotation],T=[0,1,2,3];return T.every((function(n){return T.every((function(T){var r=e.offsetX+n,M=e.offsetY+T;return!(E[T][n]!==c.EMPTY&&(r<0||r>9||M>17||t[M][r]!==c.EMPTY))}))}))}function L(e){return e.map((function(e){return e.every((function(e){return e!==c.EMPTY}))?1:0})).reduce((function(e,t){return e+t}),0)}function B(e,t){var E=e.score,T=e.level;return console.log({score:E,perLine:o[t],completedRowsCount:t}),E+o[t]*(T+1)}var _=function(e){var t=e.currentBlock.offsetY+1,E=Object(f.a)({},e.currentBlock,{offsetY:t});if(d(E,e.grid))return Object(f.a)({},e,{currentBlock:E});var T=L(e.grid),n=function(e){var t=Object(s.a)(e);return e.forEach((function(e,E){e.every((function(e){return e!==c.EMPTY}))&&(t.splice(E,1),t.unshift(O()))})),t}(function(e,t){var E=l[e.shape][e.rotation],T=[0,1,2,3],n=Object(s.a)(t);return T.forEach((function(t){T.forEach((function(T){var r=e.offsetX+t,M=e.offsetY+T,Y=E[T][t];Y!==c.EMPTY&&(n[M][r]=Y)}))})),n}(e.currentBlock,e.grid));return console.log(L),Object(f.a)({},e,{grid:n,currentBlock:e.nextBlock,nextBlock:v(),score:B(e,T)})};function b(e,t){switch(t.type){case a.MOVE_BLOCK_DOWN:return _(e);case a.MOVE_BLOCK_LEFT:return function(e){var t=e.currentBlock.offsetX-1,E=Object(f.a)({},e.currentBlock,{offsetX:t});return d(E,e.grid)?Object(f.a)({},e,{currentBlock:E}):e}(e);case a.MOVE_BLOCK_RIGHT:return function(e){var t=e.currentBlock.offsetX+1,E=Object(f.a)({},e.currentBlock,{offsetX:t});return d(E,e.grid)?Object(f.a)({},e,{currentBlock:E}):e}(e);case a.ROTATE_BLOCK_LEFT:return function(e){var t=l[e.currentBlock.shape],E=e.currentBlock.rotation,T=E>=t.length-1?Object(f.a)({},e.currentBlock,{rotation:0}):Object(f.a)({},e.currentBlock,{rotation:E+1});return d(T,e.grid)?Object(f.a)({},e,{currentBlock:T}):e}(e);case a.ROTATE_BLOCK_RIGHT:default:return e}}var h={level:0,score:0,grid:Array(18).fill(null).map((function(){return O()})),currentBlock:v(),nextBlock:v(),keybindings:{37:a.MOVE_BLOCK_LEFT,38:a.ROTATE_BLOCK_LEFT,39:a.MOVE_BLOCK_RIGHT,40:a.MOVE_BLOCK_DOWN,41:a.ROTATE_BLOCK_RIGHT}},j=Object(T.createContext)({state:h,dispatch:function(){return null}});function C(e){var t=e.children,E=Object(T.useReducer)(b,h),r=Object(i.a)(E,2),M=r[0],Y=r[1];return n.a.createElement(j.Provider,{value:{state:M,dispatch:Y}},t)}function k(){var e=Object(T.useContext)(j),t=e.state,E=e.dispatch,r=t.grid,M=t.currentBlock;return Y((function(){return E({type:a.MOVE_BLOCK_DOWN})}),1e3),n.a.createElement(P,{draw:function(e){e.clearRect(0,0,520,936),function(e){for(var t=0,E=0;E<10;t+=52,E++)for(var T=0,n=0;n<18;T+=52,n++){var M=r[n][E];e.fillStyle=u[M],e.fillRect(t,T,50,50)}}(e),function(e){for(var t=0,E=0;E<4;t+=52,E++)for(var T=0,n=0;n<4;T+=52,n++){var r=M.shape,Y=M.rotation,P=52*M.offsetX+t,o=52*M.offsetY+T,a=l[r][Y][n][E];a!==c.EMPTY&&(e.fillStyle=u[a],e.fillRect(P,o,50,50))}}(e)},width:520,height:936,delay:2})}function m(){var e=Object(T.useContext)(j),t=e.state,E=e.dispatch,r=t.keybindings;return Object(T.useEffect)((function(){var e=function(e){E({type:r[e.keyCode]})};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[r,E]),n.a.createElement(n.a.Fragment,null)}function p(){var e=Object(T.useContext)(j).state.score;return console.log(e),n.a.createElement("div",null,"Score: ",e)}function y(){var e=Object(T.useContext)(j).state.level;return n.a.createElement("div",null,"Level: ",e)}function R(){var e=Object(T.useContext)(j).state.nextBlock;return n.a.createElement(P,{draw:function(t){for(var E=l[e.shape][e.rotation],T=0,n=0;n<4;T+=52,n++)for(var r=0,M=0;M<4;r+=52,M++){var Y=E[M][n];t.fillStyle=u[Y],t.fillRect(T,r,50,50)}},width:208,height:208,delay:2})}var g=E(5),I=E(6);function K(){var e=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n"]);return K=function(){return e},e}function J(){var e=Object(g.a)(["\n  color: red;\n  display: flex;\n  justify-content: center;\n"]);return J=function(){return e},e}var w=I.a.div(J()),x=I.a.div(K());function S(){return n.a.createElement(C,null,n.a.createElement(m,null),n.a.createElement(k,null),n.a.createElement(x,null,n.a.createElement(R,null),n.a.createElement(p,null),n.a.createElement(y,null)))}function V(){return n.a.createElement(w,null,n.a.createElement(S,null))}function A(){return n.a.createElement(V,null)}M.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(A,null)),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.63310fb1.chunk.js.map